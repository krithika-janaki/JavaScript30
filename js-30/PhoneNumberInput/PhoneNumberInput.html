<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div>
    <input type="text" />
    </div>
    <script>
        const textField = document.querySelector('input');
        const globalCursor = 0;

        function handleInput(e) {
            const ele = e.target;
            let value = ele.value;
            const cursor = ele.selectionStart;
            console.log({cursor, globalCursor})
             value = value.replace(/[^0-9]/g, '').slice(0, 10);

             if(value.length > 10) {
                return;
             }

             let res = '';

             if(value.length > 0) {
                res = '(' + value;
             }

             if(value.length > 3) {
                res = '(' + value.slice(0,3) + ')' + ' ' + value.slice(3);
             }

             if(value.length > 6) {
                res = '(' + value.slice(0,3) + ')' + ' ' + value.slice(3, 6) + ' - ' + value.slice(6)
             }

             if(cursor) {
               
                const diff = res.length - value.length;
                console.log({cursor, diff})
                e.target.setSelectionRange(cursor + diff, cursor + diff);
             }
             console.log({value, res})
             e.target.value = res;
            
        }

        textField.addEventListener('input', handleInput);
        textField.addEventListener('keydown', handleInput);
    </script>
</body>
</html>